outliers = 0
for (i in df$wv ){
  if(i>5){
    outliers=outliers+1
  }
}
print(outliers)

## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
outliers_rh=0
for(i in 1:nrow(df)){
  if(df$rh[i]<50){
    outliers_rh=outliers_rh+1
  }
}
print(outliers_rh)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
v = c()
for(i in 1:nrow(df)){
  if(df$wv[i]>5){
    v=append(v,i)
  }
}
df = df[-v,]
summary(df$wv)
cor(df[-1])

model3 = lm(wv~rh,df)
summary(model3)

## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
ggplot(data=df) + 
  geom_point(mapping=aes(x=rh,y=wv,color=wv))


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
plot(df$wv~df$rh,col='red',xlab='relative humidity',ylab='wind speed')
abline(model3,col='blue')


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
ggplot(data=df)+
  geom_point(mapping=aes(x=rh,y=wv,color=wv))+
  geom_smooth(mapping=aes(x=rh,y=wv))


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
v = c()
for(i in 1:nrow(df)){
  if(df$rh[i]<50){
    v=append(v,i)
  }
}
df = df[-v,]
summary(df$rh)
print("")
cor(df[-1])


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
ggplot(data=df) + 
  geom_point(mapping=aes(x=wv,y=rh,color=wv))   



## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
model4 = lm(wv~rh,df)
summary(model4)
plot(df$wv~df$rh,col='red',xlab='relative humidity',ylab='wind speed')
abline(model4,col='blue')


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
df = read.csv('weather.csv')
v = c()
for(i in 1:nrow(df)){
  if(df$wv[i]<0 || df$wvMax[i]<0){
    v=append(v,i)
  }
}
df = df[-v,]
