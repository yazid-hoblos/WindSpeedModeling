## ----eval=F------------------------------------------------------------------------------------------------------------------------------------------------------------
## for(i in 1:nrow(df)){
##   if (new_df$date[i]==11 || new_df$date[i]==12 || new_df$date[i]==1 || new_df$date[i]==2){
##     new_df$date123[i]=1
##   }else if (new_df$date[i]==3 || new_df$date[i]==4 || new_df$date[i]==5 || new_df$date[i]==6){
##     new_df$date123[i]=2
##   }else{
##     new_df$date123=3
##   }
## }
## 
## write.csv(new_df,'weather_categorized.csv')


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
d = read.csv("weather_categorized.csv")
View(d)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
d$date123 = as.factor(d$date123)
memory.limit(5000) # Just used to let R continue processing after the allocated memory was filled
summary(d$date123)
model123 = lm(wv~I(rh^2)*Vpmax*temperature*pressure*rho*wd+date123,d)
summary(model123)


## ----eval=F------------------------------------------------------------------------------------------------------------------------------------------------------------
## for(i in 1:nrow(d)){
##   if (d$date[i]==4 || d$date[i]==5 || d$date[i]==6){
##     d$date123[i]=2
##   }else if (d$date[i]==10 || d$date[i]==2 ||d$date[i]==3){
##     new_df$date123[i]=3
##   }
## }
## 
## write.csv(new_df,'weather_categorized_updated.csv')


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
data = read.csv('weather_categorized_updated.csv')
data$date123 = as.factor(data$date123)
model123 = lm(wv~I(rh^2)*Vpmax*temperature*pressure*rho*wd+date123,data)
summary(model123)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
dd = read.csv('newweather.csv')
v=c()
for(i in 1:nrow(dd)){
  if(dd$date[i]==1){
    v=append(v,i)
  }
}

df_01 = dd[v,]


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
View(df_01)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
model_01 = lm(wv~I(rh^2)*Vpmax*temperature*pressure*rho*wd,df_01)
summary(model_01)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
model_01 = lm(wv~rh*Vpmax*pressure+I(rh^2)*temperature*rho*wd,df_01)
summary(model_01)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
d1 = df_01[1:4463,]
final = lm(wv~I(rh^2)*Vpmax*temperature*pressure*rho*wd,d1)
summary(final)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
nn = lm(wv~rh*Vpmax*pressure+I(rh^2)*temperature*rho*wd,d1)
summary(nn)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
plot_data <- data.frame(Predicted_value = predict(final),  
                       Observed_value = d1$wv)
  
ggplot(plot_data, aes(x = Predicted_value, y = Observed_value)) +
                  geom_point()



## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
mean(summary(model11)$residuals^2)
mean(summary(final)$residuals^2)


## ----eval=F------------------------------------------------------------------------------------------------------------------------------------------------------------
## colnames(data)[1]='date'
## v=c()
## for(i in 1:nrow(data)){
##   if (substr(data$date[i],4,5)=='01'){
##   if(substr(data$date[i],4,4)=='0'){
##     data$time[i]=strtoi(substr(data$date[i],13,13))
##   }else{
##     data$time[i]=strtoi(substr(data$date[i],12,13))
##   }
##   data$date[i]=substr(data$date[i],4,5)}
##   else{
##     v=append(v,i)
##   }}
## data = data[-v,]
## unique(data$date)
## unique(data$time)

